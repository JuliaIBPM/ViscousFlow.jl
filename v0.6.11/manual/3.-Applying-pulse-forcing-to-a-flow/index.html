<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Applying pulse forcing to a flow · ViscousFlow.jl</title><meta name="title" content="Applying pulse forcing to a flow · ViscousFlow.jl"/><meta property="og:title" content="Applying pulse forcing to a flow · ViscousFlow.jl"/><meta property="twitter:title" content="Applying pulse forcing to a flow · ViscousFlow.jl"/><meta name="description" content="Documentation for ViscousFlow.jl."/><meta property="og:description" content="Documentation for ViscousFlow.jl."/><meta property="twitter:description" content="Documentation for ViscousFlow.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ViscousFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../1.-Basic-viscous-flow/">Basic viscous flow</a></li><li><a class="tocitem" href="../2.-Basic-flow-with-a-stationary-body/">Basic flow with a stationary body</a></li><li class="is-active"><a class="tocitem" href>Applying pulse forcing to a flow</a></li><li><a class="tocitem" href="../4.-Multiple-stationary-bodies/">Multiple stationary bodies</a></li><li><a class="tocitem" href="../5.-Moving-reference-frame/">Moving reference frame</a></li><li><a class="tocitem" href="../6.-Viscous-flow-about-a-moving-body/">Viscous flow about moving bodies</a></li><li><a class="tocitem" href="../7.-Variable-free-stream/">Variable free stream</a></li><li><a class="tocitem" href="../8.-Lid-driven-cavity/">Lid-driven cavity flow</a></li><li><a class="tocitem" href="../9.-Exogenous-degrees-of-freedom/">Exogenous degrees of freedom</a></li><li><a class="tocitem" href="../functions/">Functions and types</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Applying pulse forcing to a flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Applying pulse forcing to a flow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ViscousFlow.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ViscousFlow.jl/blob/master/test/literate/3.-Applying-pulse-forcing-to-a-flow.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Applying-pulse-forcing-to-a-flow"><a class="docs-heading-anchor" href="#Applying-pulse-forcing-to-a-flow">Applying pulse forcing to a flow</a><a id="Applying-pulse-forcing-to-a-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Applying-pulse-forcing-to-a-flow" title="Permalink"></a></h1><p>Here, we will show how to apply a transient force to a flow.</p><pre><code class="language-julia hljs">using ViscousFlow</code></pre><pre><code class="language-julia hljs">using Plots</code></pre><p>For this case, we first seek to introduce a pulse to an otherwise quiescent fluid, with no boundaries. The pulse shape will be a smooth Gaussian-distributed force, directed upward.</p><p>We will start with the usual steps: specify the problem parameters and the discretization.</p><pre><code class="language-julia hljs">my_params = Dict()

my_params[&quot;Re&quot;] = 200
xlim = (-2.0,2.0)
ylim = (-2.0,4.0)
my_params[&quot;grid Re&quot;] = 4.0
g = setup_grid(xlim,ylim,my_params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PhysicalGrid{2}((208, 308), (104, 103), 0.02, ((-2.06, 2.06), (-2.04, 4.08)), 1)</code></pre><h3 id="Construct-the-forcing"><a class="docs-heading-anchor" href="#Construct-the-forcing">Construct the forcing</a><a id="Construct-the-forcing-1"></a><a class="docs-heading-anchor-permalink" href="#Construct-the-forcing" title="Permalink"></a></h3><p>There are a variety of forcing types available to us. Here, we will use <em>area-type forcing</em>, which is distributed over a region of space. We will create a short-lived force applied in the vertical direction in this region. For the spatial distribution of this forcing, we make use of a Gaussian field. We will center it at (0,0), and give it a strength of 10, using the <code>SpatialGaussian</code> constructor. The x component of the force we set to zero, using the <code>EmptySpatialField</code> constructor.</p><pre><code class="language-julia hljs">σx = 0.5
σy = 0.1
x0 = y0 = 0.0
amp = 10
force_dist = [EmptySpatialField(),SpatialGaussian(σx,σy,x0,y0,amp)];</code></pre><p>When we introduce forcing in any problem, it is essential to supply a <em>model function</em> that supplies the instantaneous strength of the forcing. This gives us the opportunity to specify the transient aspect of the forcing. In this example, we modulate the force in time with a Gaussian, with a small half-width in time equal to <span>$\sigma_t = 0.1$</span>, effectively creating a pulse. We center it at time <span>$t_0 = 0.1$</span> (using the <code>&gt;&gt;</code> shift operator). This is carried out in the function below, in which we create the modulating function <code>modfcn</code>. Note that <code>fr.generated_field()</code> provides the spatial distribution that we specified with our spatial field <code>force_dist</code>. This is multiplied by <code>modfcn</code>, our Gaussian pulse, evaluated at the current time.</p><pre><code class="language-julia hljs">function forcing_model!(σ,T,t,fr::AreaRegionCache,phys_params)
    σt = 0.1
    t0 = 0.1
    modfcn = Gaussian(σt,sqrt(π*σt^2)) &gt;&gt; t0
    σ .= modfcn(t)*fr.generated_field()
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">forcing_model! (generic function with 1 method)</code></pre><p>We pack the model function and the spatial field together into an <code>AreaForcingModel</code>, which we then put into a forcing dictionary. It is important to use the key &quot;forcing models&quot; for this.</p><pre><code class="language-julia hljs">afm = AreaForcingModel(forcing_model!,spatialfield=force_dist)
forcing_dict = Dict(&quot;forcing models&quot; =&gt; afm);</code></pre><h3 id="Construct-the-system-structure"><a class="docs-heading-anchor" href="#Construct-the-system-structure">Construct the system structure</a><a id="Construct-the-system-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Construct-the-system-structure" title="Permalink"></a></h3><p>We supply these forcing characteristics with the keyword argument <code>forcing</code> as we set up the usual system structure:</p><pre><code class="language-julia hljs">sys = viscousflow_system(g,phys_params=my_params,forcing=forcing_dict);</code></pre><p>The remaining steps go just as they did for the previous examples. We will simulate the pulse for 4 time units:</p><pre><code class="language-julia hljs">u0 = init_sol(sys)
tspan = (0.0,10.0) # longer than we need, but just being safe
integrator = init(u0,tspan,sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">t: 0.0
u: (Dual nodes in a (nx = 208, ny = 308) cell grid of type Float64 data
  Number of Dual nodes: (nx = 208, ny = 308), Float64[])</code></pre><pre><code class="language-julia hljs">step!(integrator,4.0)</code></pre><h3 id="Examine"><a class="docs-heading-anchor" href="#Examine">Examine</a><a id="Examine-1"></a><a class="docs-heading-anchor-permalink" href="#Examine" title="Permalink"></a></h3><p>Let&#39;s look at a sequence of snapshots of the forced flow. As we see, this short-lived force creates a dipole-like pair of counter-rotating vortices that propagates upward under its own influence.</p><pre><code class="language-julia hljs">sol = integrator.sol
plt = plot(layout = (1,4), size = (800, 300), legend=:false)
tsnap = 0.1:1.0:3.1
for (i, t) in enumerate(tsnap)
    plot!(plt[i],vorticity(sol,sys,t),sys,title=&quot;t = $(round(t,digits=2))&quot;)
end
plt</code></pre><img src="5cd7b457.svg" alt="Example block output"/><p>And here is another look a the flow, this time with streamlines:</p><pre><code class="language-julia hljs">plot(streamfunction(integrator),sys,title=&quot;Streamfunction at t = $(round(integrator.t,digits=2))&quot;)</code></pre><img src="5546ea88.svg" alt="Example block output"/><p>We can also supply more than one pulse. If we don&#39;t change the spatial distribution, then we just redefine the model function and run it again: Let&#39;s give 3 pulses, each separated by 1 time unit.</p><pre><code class="language-julia hljs">function forcing_model!(σ,T,t,fr::AreaRegionCache,phys_params)
    σt = 0.1
    t0 = [0.1, 1.1, 2.1]
    modfcn = (Gaussian(σt,sqrt(π*σt^2)) &gt;&gt; t0[1]) +
             (Gaussian(σt,sqrt(π*σt^2)) &gt;&gt; t0[2]) +
             (Gaussian(σt,sqrt(π*σt^2)) &gt;&gt; t0[3])
    σ .= modfcn(t)*fr.generated_field()
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">forcing_model! (generic function with 1 method)</code></pre><pre><code class="language-julia hljs">u0 = init_sol(sys)
integrator = init(u0,tspan,sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">t: 0.0
u: (Dual nodes in a (nx = 208, ny = 308) cell grid of type Float64 data
  Number of Dual nodes: (nx = 208, ny = 308), Float64[])</code></pre><pre><code class="language-julia hljs">step!(integrator,4.0)</code></pre><h3 id="Examine-2"><a class="docs-heading-anchor" href="#Examine-2">Examine</a><a class="docs-heading-anchor-permalink" href="#Examine-2" title="Permalink"></a></h3><p>In this case, the pulses coalesce with one another</p><pre><code class="language-julia hljs">sol = integrator.sol
plt = plot(layout = (1,4), size = (800, 300), legend=:false)
tsnap = 0.1:1.0:3.1
for (i, t) in enumerate(tsnap)
    plot!(plt[i],vorticity(sol,sys,t),sys,title=&quot;t = $(round(t,digits=2))&quot;)
end
plt</code></pre><img src="102372b6.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../2.-Basic-flow-with-a-stationary-body/">« Basic flow with a stationary body</a><a class="docs-footer-nextpage" href="../4.-Multiple-stationary-bodies/">Multiple stationary bodies »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 23 October 2024 07:18">Wednesday 23 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
