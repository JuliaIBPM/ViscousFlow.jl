<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lid-driven cavity flow · ViscousFlow.jl</title><meta name="title" content="Lid-driven cavity flow · ViscousFlow.jl"/><meta property="og:title" content="Lid-driven cavity flow · ViscousFlow.jl"/><meta property="twitter:title" content="Lid-driven cavity flow · ViscousFlow.jl"/><meta name="description" content="Documentation for ViscousFlow.jl."/><meta property="og:description" content="Documentation for ViscousFlow.jl."/><meta property="twitter:description" content="Documentation for ViscousFlow.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ViscousFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../1.-Basic-viscous-flow/">Basic viscous flow</a></li><li><a class="tocitem" href="../2.-Basic-flow-with-a-stationary-body/">Basic flow with a stationary body</a></li><li><a class="tocitem" href="../3.-Applying-pulse-forcing-to-a-flow/">Applying pulse forcing to a flow</a></li><li><a class="tocitem" href="../4.-Multiple-stationary-bodies/">Multiple stationary bodies</a></li><li><a class="tocitem" href="../5.-Moving-reference-frame/">Moving reference frame</a></li><li><a class="tocitem" href="../6.-Viscous-flow-about-a-moving-body/">Viscous flow about moving bodies</a></li><li><a class="tocitem" href="../7.-Variable-free-stream/">Variable free stream</a></li><li class="is-active"><a class="tocitem" href>Lid-driven cavity flow</a><ul class="internal"><li><a class="tocitem" href="#Problem-specification"><span>Problem specification</span></a></li><li><a class="tocitem" href="#Discretization"><span>Discretization</span></a></li><li><a class="tocitem" href="#Cavity-Geometry"><span>Cavity Geometry</span></a></li><li><a class="tocitem" href="#Boundary-Condition-at-the-moving-wall"><span>Boundary Condition at the moving wall</span></a></li><li><a class="tocitem" href="#Construct-the-system-structure"><span>Construct the system structure</span></a></li><li><a class="tocitem" href="#Solve"><span>Solve</span></a></li><li><a class="tocitem" href="#Examine"><span>Examine</span></a></li></ul></li><li><a class="tocitem" href="../9.-Exogenous-degrees-of-freedom/">Exogenous degrees of freedom</a></li><li><a class="tocitem" href="../functions/">Functions and types</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Lid-driven cavity flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lid-driven cavity flow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ViscousFlow.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ViscousFlow.jl/blob/master/test/literate/8.-Lid-driven-cavity.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Lid-driven-cavity-flow"><a class="docs-heading-anchor" href="#Lid-driven-cavity-flow">Lid-driven cavity flow</a><a id="Lid-driven-cavity-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Lid-driven-cavity-flow" title="Permalink"></a></h1><p>In this notebook we will simulate the flow in a square cavity with a top moving wall.</p><pre><code class="language-julia hljs">using ViscousFlow</code></pre><pre><code class="language-julia hljs">using Plots</code></pre><h2 id="Problem-specification"><a class="docs-heading-anchor" href="#Problem-specification">Problem specification</a><a id="Problem-specification-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-specification" title="Permalink"></a></h2><p>Take <span>$Re=100$</span> for example:</p><pre><code class="language-julia hljs">my_params = Dict()
my_params[&quot;Re&quot;] = 100</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100</code></pre><h2 id="Discretization"><a class="docs-heading-anchor" href="#Discretization">Discretization</a><a id="Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization" title="Permalink"></a></h2><p>Note that the rectangle function used for making the cavity shape requires a specified half length. The immersed boundary projection method for internal flow requires the size of the domain to be at least a step size greater at the boundaries (i.e. <code>halflength + Δx</code>). So, for safety we make it 2 percent greater on each side.</p><p>Also, we set the grid Reynolds number to 0.5, lower than default of 2, so we have more accuracy. We also set the CFL number to 1.0, larger than the default of 0.5, so we can get to steady state faster.</p><pre><code class="language-julia hljs">halflength=0.5
domain_lim=1.02*halflength
xlim, ylim = (-domain_lim,domain_lim),(-domain_lim,domain_lim)
my_params[&quot;grid Re&quot;] = 0.5
my_params[&quot;CFL&quot;] = 1.0
g = setup_grid(xlim,ylim,my_params)

Δs = surface_point_spacing(g,my_params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.006999999999999999</code></pre><h2 id="Cavity-Geometry"><a class="docs-heading-anchor" href="#Cavity-Geometry">Cavity Geometry</a><a id="Cavity-Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Cavity-Geometry" title="Permalink"></a></h2><p>A square cavity can be created using the <code>Rectangle()</code> function with the half length defined above. We place its center at the origin.</p><pre><code class="language-julia hljs">body = Rectangle(halflength,halflength,Δs)
X = MotionTransform([0.0,0.0],0.0)
joint = Joint(X)
m = RigidBodyMotion(joint,body)
x = init_motion_state(body,m)
update_body!(body,x,m)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Closed polygon with 4 vertices and 572 points
   Current position: (0.0,0.0)
   Current angle (rad): 0.0
</code></pre><pre><code class="language-julia hljs">plot(body,fillrange=nothing)</code></pre><img src="aefe9a95.svg" alt="Example block output"/><h2 id="Boundary-Condition-at-the-moving-wall"><a class="docs-heading-anchor" href="#Boundary-Condition-at-the-moving-wall">Boundary Condition at the moving wall</a><a id="Boundary-Condition-at-the-moving-wall-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Condition-at-the-moving-wall" title="Permalink"></a></h2><p>Assign velocity to the top boundary (in the interior of the square). To do this, we redefine the interior boundary condition function (the &quot;interior&quot; key of the bc dictionary). We don&#39;t have to touch the exterior boundary condition, because it defaults to zero, as we desire.</p><p>Rectangles and other polygon shapes in the <code>RigidBodyTools.jl</code> package have a <code>side</code> field that allows easy access to the index range for each side. Here, we use that feature to set the <span>$x$</span> velocity along the top to 1. We also use the <code>view</code> function to provide access to the part of the overall velocity vector associated with body 1. That&#39;s not particularly important in this example, since there is only one body, but it is useful in problems that have multiple bodies.</p><pre><code class="language-julia hljs">function my_vsminus(t,x,base_cache,phys_params,motions)
  vsminus = zeros_surface(base_cache)
  vsu = view(vsminus.u,base_cache,1)

  top = base_cache.bl[1].side[3]
  vsu[top] .= 1.0
  return vsminus
end

bcdict = Dict(&quot;interior&quot; =&gt; my_vsminus)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{String, typeof(Main.my_vsminus)} with 1 entry:
  &quot;interior&quot; =&gt; my_vsminus</code></pre><h2 id="Construct-the-system-structure"><a class="docs-heading-anchor" href="#Construct-the-system-structure">Construct the system structure</a><a id="Construct-the-system-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Construct-the-system-structure" title="Permalink"></a></h2><p>Now we provide our parameters and the boundary condition dictionary.</p><pre><code class="language-julia hljs">sys = viscousflow_system(g,body,phys_params=my_params,bc=bcdict,motions=m);</code></pre><p>Initialize</p><pre><code class="language-julia hljs">u0 = init_sol(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Dual nodes in a (nx = 208, ny = 210) cell grid of type Float64 data
  Number of Dual nodes: (nx = 208, ny = 210), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0])</code></pre><p>Set up integrator</p><pre><code class="language-julia hljs">tspan = (0.0,10.0)
integrator = init(u0,tspan,sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">t: 0.0
u: (Dual nodes in a (nx = 208, ny = 210) cell grid of type Float64 data
  Number of Dual nodes: (nx = 208, ny = 210), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0])</code></pre><h2 id="Solve"><a class="docs-heading-anchor" href="#Solve">Solve</a><a id="Solve-1"></a><a class="docs-heading-anchor-permalink" href="#Solve" title="Permalink"></a></h2><p>For demonstration purposes, we run this over 2 convective time units. (You can run it longer to get it to steady state.)</p><pre><code class="language-julia hljs">step!(integrator,2)</code></pre><h2 id="Examine"><a class="docs-heading-anchor" href="#Examine">Examine</a><a id="Examine-1"></a><a class="docs-heading-anchor-permalink" href="#Examine" title="Permalink"></a></h2><p>Plot the vorticity and streamlines. We take a little care with the streamlines to show the small recirculation zones in the lower corners.</p><pre><code class="language-julia hljs">mins, maxs = extrema(streamfunction(integrator))
slevs = vcat(range(mins,maxs,length=11),maxs-0.00438,maxs-0.00353,maxs-0.00348)
plot(
plot(vorticity(integrator),sys,title=&quot;Vorticity&quot;,clim=(-10,10),color=:turbo,linewidth=1.5,ylim=ylim,levels=-6:0.5:5),
plot(streamfunction(integrator),sys,title=&quot;Streamfunction&quot;,color=:black,ylim=ylim,levels=slevs)
)</code></pre><img src="1f1a3ab6.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../7.-Variable-free-stream/">« Variable free stream</a><a class="docs-footer-nextpage" href="../9.-Exogenous-degrees-of-freedom/">Exogenous degrees of freedom »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 4 September 2024 19:17">Wednesday 4 September 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
