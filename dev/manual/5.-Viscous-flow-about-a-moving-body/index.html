<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Viscous flow about a moving body · ViscousFlow.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ViscousFlow.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../1.-Basic-viscous-flow/">Basic viscous flow</a></li><li><a class="tocitem" href="../2.-Basic-flow-with-a-stationary-body/">Basic flow with a stationary body</a></li><li><a class="tocitem" href="../3.-Applying-pulse-forcing-to-a-flow/">Applying pulse forcing to a flow</a></li><li><a class="tocitem" href="../4.-Multiple-stationary-bodies/">Multiple stationary bodies</a></li><li><a class="tocitem" href="../5.-Moving-reference-frame/">Moving reference frame</a></li><li><a class="tocitem" href="../6.-Viscous-flow-about-a-moving-body/">Viscous flow about moving bodies</a></li><li><a class="tocitem" href="../7.-Variable-free-stream/">Variable free stream</a></li><li><a class="tocitem" href="../8.-Lid-driven-cavity/">Lid-driven cavity flow</a></li><li><a class="tocitem" href="../9.-Exogenous-degrees-of-freedom/">Exogenous degrees of freedom</a></li><li><a class="tocitem" href="../functions/">Functions and types</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Viscous flow about a moving body</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Viscous flow about a moving body</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Viscous-flow-about-a-moving-body"><a class="docs-heading-anchor" href="#Viscous-flow-about-a-moving-body">Viscous flow about a moving body</a><a id="Viscous-flow-about-a-moving-body-1"></a><a class="docs-heading-anchor-permalink" href="#Viscous-flow-about-a-moving-body" title="Permalink"></a></h1><p>In this notebook we will demonstrate the simulation of a moving body. It is straightforward to set up a moving body. The main caveat is that the simulation is slower, because the integrator must update the operators continuously throughout the simulation.</p><p>We will demonstrate this on an oscillating flat plate.</p><pre><code class="language-julia hljs">using ViscousFlow</code></pre><pre><code class="language-julia hljs">using Plots</code></pre><h3 id="Problem-specification-and-discretization"><a class="docs-heading-anchor" href="#Problem-specification-and-discretization">Problem specification and discretization</a><a id="Problem-specification-and-discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-specification-and-discretization" title="Permalink"></a></h3><p>For simplicity, we will not create a free stream in this problem. Everything here is the usual.</p><pre><code class="language-julia hljs">my_params = Dict()
my_params[&quot;Re&quot;] = 200</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">200</code></pre><pre><code class="language-julia hljs">xlim = (-1.0,1.0)
ylim = (-1.0,1.0)
my_params[&quot;grid Re&quot;] = 4.0
g = setup_grid(xlim,ylim,my_params)

Δs = surface_point_spacing(g,my_params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.027999999999999997</code></pre><h3 id="Set-up-body"><a class="docs-heading-anchor" href="#Set-up-body">Set up body</a><a id="Set-up-body-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-body" title="Permalink"></a></h3><p>Set up the plate and place it at the origin. (We don&#39;t actually have to move it, since it defaults to the origin, but it&#39;s helpful to put this here in case we wish to initialize it differently.)</p><pre><code class="language-julia hljs">body = Plate(1.0,Δs)
T = RigidTransform((0,0),0)
T(body)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Open polygon with 2 vertices and 36 points
   Current position: (0.0,0.0)
   Current angle (rad): 0.0
</code></pre><h3 id="Set-the-body-motion"><a class="docs-heading-anchor" href="#Set-the-body-motion">Set the body motion</a><a id="Set-the-body-motion-1"></a><a class="docs-heading-anchor-permalink" href="#Set-the-body-motion" title="Permalink"></a></h3><p>Now we specify the body motion. We will use oscillatory pitch-heave kinematics for this:</p><pre><code class="language- hljs">a = 0.25 # location of pitch axis, a = 0.5 is leading edge
ϕp = -π/2  # phase lag of pitch
ϕh = 0.0  # phase lag of heave
A = 0.25  # amplitude/chord
fstar = 1/π # fc/U
α₀ = 0 # mean angle of attack
Δα = 10π/180 # amplitude of pitching
U₀ = 0.0 # translational motion (set to zero in place of free stream)
K = π*fstar # reduced frequency, K = πfc/U

oscil1 = RigidBodyTools.PitchHeave(U₀,a,K,ϕp,α₀,Δα,A,ϕh)
motion = RigidBodyMotion(oscil1)</code></pre><p>We can inspect the kinematics in this <code>motion</code> by plotting them:</p><pre><code class="language- hljs">plot(motion)</code></pre><h3 id="Define-the-boundary-condition-functions"><a class="docs-heading-anchor" href="#Define-the-boundary-condition-functions">Define the boundary condition functions</a><a id="Define-the-boundary-condition-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Define-the-boundary-condition-functions" title="Permalink"></a></h3><p>Instead of using the default boundary condition functions, we define special ones here that provide the instantaneous surface velocity (i.e. the velocity of every surface point) from the prescribed motion. Every surface has an &quot;exterior&quot; and &quot;interior&quot; side. For a flat plate, these two sides are the upper and lower sides, and both sides are next to the fluid, so both of them are assigned the prescribed velocity of the plate. (For closed bodies, we would assign this velocity to only one of the sides, and zero to the other side. We will see an example of this in a later case.) We pack these into a special dictionary and pass these to the system construction.</p><pre><code class="language-julia hljs">function my_vsplus(t,base_cache,phys_params,motions)
  vsplus = zeros_surface(base_cache)
  surface_velocity!(vsplus,base_cache,motions,t)
  return vsplus
end

function my_vsminus(t,base_cache,phys_params,motions)
  vsminus = zeros_surface(base_cache)
  surface_velocity!(vsminus,base_cache,motions,t)
  return vsminus
end

bcdict = Dict(&quot;exterior&quot; =&gt; my_vsplus, &quot;interior&quot; =&gt; my_vsminus)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{String, Function} with 2 entries:
  &quot;interior&quot; =&gt; my_vsminus
  &quot;exterior&quot; =&gt; my_vsplus</code></pre><h3 id="Construct-the-system-structure"><a class="docs-heading-anchor" href="#Construct-the-system-structure">Construct the system structure</a><a id="Construct-the-system-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Construct-the-system-structure" title="Permalink"></a></h3><p>Here, we supply the motion and boundary condition functions as additional arguments.</p><pre><code class="language- hljs">sys = viscousflow_system(g,body,phys_params=my_params,motions=motion,bc=bcdict);
nothing #hide</code></pre><p>Before we solve the problem, it is useful to note that the Reynolds number we specified earlier may not be the most physically-meaningful Reynolds number. More relevant in this problem is the Reynolds number based on the maximum body speed.</p><pre><code class="language- hljs">Umax, imax, tmax, bmax = maxlistvelocity(sys)
Re_eff = my_params[&quot;Re&quot;]*Umax</code></pre><pre><code class="language- hljs">u0 = init_sol(sys)
tspan = (0.0,10.0)
integrator = init(u0,tspan,sys)</code></pre><h3 id="Solve"><a class="docs-heading-anchor" href="#Solve">Solve</a><a id="Solve-1"></a><a class="docs-heading-anchor-permalink" href="#Solve" title="Permalink"></a></h3><p>This takes longer per time step than it does for stationary bodies. Here, we only run it for 1.5 time units just to demonstrate it.</p><pre><code class="language- hljs">@time step!(integrator,1.5)</code></pre><h3 id="Examine-the-solution"><a class="docs-heading-anchor" href="#Examine-the-solution">Examine the solution</a><a id="Examine-the-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Examine-the-solution" title="Permalink"></a></h3><p>Let&#39;s look at a few snapshots of the vorticity field. Note that the plotting here requires us to explicitly call the <a href="manual/@ref"><code>surfaces</code></a> function to generate the instantaneous configuration of the plate.</p><pre><code class="language- hljs">sol = integrator.sol
plt = plot(layout = (1,3), size = (800, 300), legend=:false)
tsnap = 0.5:0.5:1.5
for (i, t) in enumerate(tsnap)
    plot!(plt[i],vorticity(sol,sys,t),sys,layers=false,title=&quot;t = $(round(t,digits=2))&quot;,clim=(-5,5),levels=range(-5,5,length=30),color = :RdBu)
    plot!(plt[i],surfaces(sol,sys,t))
end
plt</code></pre><p>and the forces</p><pre><code class="language- hljs">sol = integrator.sol
fx, fy = force(sol,sys,1);
nothing #hide</code></pre><pre><code class="language- hljs">plot(
plot(sol.t,2*fx,xlim=(0,Inf),ylim=(-3,3),xlabel=&quot;Convective time&quot;,ylabel=&quot;\$C_D\$&quot;,legend=:false),
plot(sol.t,2*fy,xlim=(0,Inf),ylim=(-6,6),xlabel=&quot;Convective time&quot;,ylabel=&quot;\$C_L\$&quot;,legend=:false),
    size=(800,350)
)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 14 September 2023 16:26">Thursday 14 September 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
